{"ast":null,"code":"import React,{useEffect,useState,useRef}from'react';import'./Offers.css';// Offers will be loaded from the backend (if available). No mocked data here.\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function formatRemaining(ms){if(ms<=0)return'00:00:00';const sec=Math.floor(ms/1000)%60;const min=Math.floor(ms/(1000*60))%60;const hr=Math.floor(ms/(1000*60*60));return[hr,min,sec].map(n=>String(n).padStart(2,'0')).join(':');}export default function Offers(){const[now,setNow]=useState(Date.now());const[offers,setOffers]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const trackRef=useRef(null);useEffect(()=>{const t=setInterval(()=>setNow(Date.now()),1000);return()=>clearInterval(t);},[]);useEffect(()=>{let mounted=true;setLoading(true);const base=process.env.REACT_APP_API_BASE||process.env.REACT_APP_API_URL||'http://localhost:5000';fetch(\"\".concat(base,\"/api/offers\")).then(res=>{if(!res.ok)throw new Error(\"HTTP \".concat(res.status));return res.json();}).then(data=>{if(mounted){const arr=Array.isArray(data)?data:[];// normalize fields to what the UI expects\nconst normalized=arr.map(o=>({_id:o._id,title:o.title,description:o.description,image:o.image?o.image.startsWith('http')?o.image:\"\".concat(base).concat(o.image):'/assets/placeholder.jpg',endsAt:o.endDate?Date.parse(o.endDate):null,restaurantName:o.restaurantId&&o.restaurantId.name?o.restaurantId.name:''}));setOffers(normalized);}}).catch(err=>{console.debug('No offers endpoint or failed to load offers',err);if(mounted)setOffers([]);}).finally(()=>{if(mounted)setLoading(false);});return()=>{mounted=false;};},[]);const slide=function(){let dir=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;if(!trackRef.current)return;const w=trackRef.current.clientWidth;trackRef.current.scrollBy({left:Math.round(w*0.6)*dir,behavior:'smooth'});};return/*#__PURE__*/_jsxs(\"section\",{className:\"offers-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"offers-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Offers & Deals\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"offers-controls\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>slide(-1),children:\"\\u2039\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>slide(1),children:\"\\u203A\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"offers-track\",ref:trackRef,children:[loading&&/*#__PURE__*/_jsx(\"div\",{style:{padding:16},children:\"Loading offers...\"}),!loading&&offers.length===0&&/*#__PURE__*/_jsx(\"div\",{style:{padding:16},children:\"No offers found.\"}),!loading&&offers.map(o=>/*#__PURE__*/_jsxs(\"div\",{className:\"offer-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:o.image,alt:o.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"offer-body\",children:[/*#__PURE__*/_jsx(\"h3\",{children:o.title}),/*#__PURE__*/_jsx(\"div\",{className:\"offer-desc\",children:o.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"offer-meta small\",children:[o.restaurantName,\" \\u2022 \",o.endsAt?new Date(o.endsAt).toLocaleDateString():'—']}),/*#__PURE__*/_jsx(\"div\",{className:\"offer-countdown small\",children:o.endsAt?formatRemaining(o.endsAt-now):''})]})]},o._id))]})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","jsx","_jsx","jsxs","_jsxs","formatRemaining","ms","sec","Math","floor","min","hr","map","n","String","padStart","join","Offers","now","setNow","Date","offers","setOffers","loading","setLoading","error","setError","trackRef","t","setInterval","clearInterval","mounted","base","process","env","REACT_APP_API_BASE","REACT_APP_API_URL","fetch","concat","then","res","ok","Error","status","json","data","arr","Array","isArray","normalized","o","_id","title","description","image","startsWith","endsAt","endDate","parse","restaurantName","restaurantId","name","catch","err","console","debug","finally","slide","dir","arguments","length","undefined","current","w","clientWidth","scrollBy","left","round","behavior","className","children","onClick","ref","style","padding","src","alt","toLocaleDateString"],"sources":["E:/Resturant/client/src/components/Offers.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport './Offers.css';\r\n\r\n// Offers will be loaded from the backend (if available). No mocked data here.\r\n\r\nfunction formatRemaining(ms) {\r\n  if (ms <= 0) return '00:00:00';\r\n  const sec = Math.floor(ms / 1000) % 60;\r\n  const min = Math.floor(ms / (1000 * 60)) % 60;\r\n  const hr = Math.floor(ms / (1000 * 60 * 60));\r\n  return [hr, min, sec].map(n => String(n).padStart(2,'0')).join(':');\r\n}\r\n\r\nexport default function Offers() {\r\n  const [now, setNow] = useState(Date.now());\r\n  const [offers, setOffers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const trackRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const t = setInterval(() => setNow(Date.now()), 1000);\r\n    return () => clearInterval(t);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    setLoading(true);\r\n    const base = process.env.REACT_APP_API_BASE || process.env.REACT_APP_API_URL || 'http://localhost:5000';\r\n    fetch(`${base}/api/offers`)\r\n      .then(res => {\r\n        if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n        return res.json();\r\n      })\r\n      .then(data => {\r\n        if (mounted) {\r\n          const arr = Array.isArray(data) ? data : [];\r\n          // normalize fields to what the UI expects\r\n          const normalized = arr.map(o => ({\r\n            _id: o._id,\r\n            title: o.title,\r\n            description: o.description,\r\n            image: o.image ? (o.image.startsWith('http') ? o.image : `${base}${o.image}`) : '/assets/placeholder.jpg',\r\n            endsAt: o.endDate ? Date.parse(o.endDate) : null,\r\n            restaurantName: o.restaurantId && o.restaurantId.name ? o.restaurantId.name : ''\r\n          }));\r\n          setOffers(normalized);\r\n        }\r\n      })\r\n      .catch(err => { console.debug('No offers endpoint or failed to load offers', err); if (mounted) setOffers([]); })\r\n      .finally(() => { if (mounted) setLoading(false); });\r\n    return () => { mounted = false; };\r\n  }, []);\r\n\r\n  const slide = (dir=1) => {\r\n    if (!trackRef.current) return;\r\n    const w = trackRef.current.clientWidth;\r\n    trackRef.current.scrollBy({ left: Math.round(w * 0.6) * dir, behavior: 'smooth' });\r\n  };\r\n\r\n  return (\r\n    <section className=\"offers-section\">\r\n      <div className=\"offers-header\">\r\n        <h2>Offers & Deals</h2>\r\n        <div className=\"offers-controls\">\r\n          <button onClick={() => slide(-1)}>‹</button>\r\n          <button onClick={() => slide(1)}>›</button>\r\n        </div>\r\n      </div>\r\n      <div className=\"offers-track\" ref={trackRef}>\r\n        {loading && <div style={{padding:16}}>Loading offers...</div>}\r\n        {!loading && offers.length === 0 && <div style={{padding:16}}>No offers found.</div>}\r\n        {!loading && offers.map(o => (\r\n          <div key={o._id} className={`offer-card`}>\r\n            <img src={o.image} alt={o.title} />\r\n            <div className=\"offer-body\">\r\n              <h3>{o.title}</h3>\r\n              <div className=\"offer-desc\">{o.description}</div>\r\n              <div className=\"offer-meta small\">{o.restaurantName} • {o.endsAt ? new Date(o.endsAt).toLocaleDateString() : '—'}</div>\r\n              <div className=\"offer-countdown small\">{o.endsAt ? formatRemaining(o.endsAt - now) : ''}</div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </section>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}